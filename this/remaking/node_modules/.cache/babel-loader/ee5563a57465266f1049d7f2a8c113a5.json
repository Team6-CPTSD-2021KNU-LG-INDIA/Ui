{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Touch = exports[\"default\"] = void 0;\n\nvar _handle = require(\"@enact/core/handle\");\n\nvar _dispatcher = require(\"@enact/core/dispatcher\");\n\nvar _complement = _interopRequireDefault(require(\"ramda/src/complement\"));\n\nvar _platform = _interopRequireDefault(require(\"@enact/core/platform\"));\n\nvar _config = require(\"./config\");\n\nvar _state = require(\"./state\");\n\nvar _ClickAllow = _interopRequireDefault(require(\"./ClickAllow\"));\n\nvar _Drag = require(\"./Drag\");\n\nvar _Flick = require(\"./Flick\");\n\nvar _Hold = require(\"./Hold\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar getEventCoordinates = function getEventCoordinates(ev) {\n  var x = ev.clientX,\n      y = ev.clientY,\n      type = ev.type;\n\n  if (type.indexOf('touch') === 0) {\n    x = ev.targetTouches[0].clientX;\n    y = ev.targetTouches[0].clientY;\n  }\n\n  return {\n    x: x,\n    y: y\n  };\n}; // Establish a standard payload for onDown/onUp/onTap events and pass it along to a handler\n\n\nvar makeTouchableEvent = function makeTouchableEvent(type) {\n  return function (ev) {\n    var target = ev.target,\n        currentTarget = ev.currentTarget;\n    var clientX = ev.clientX,\n        clientY = ev.clientY,\n        pageX = ev.pageX,\n        pageY = ev.pageY;\n\n    if (ev.changedTouches) {\n      clientX = ev.changedTouches[0].clientX;\n      clientY = ev.changedTouches[0].clientY;\n      pageX = ev.changedTouches[0].pageX;\n      pageY = ev.changedTouches[0].pageY;\n    }\n\n    return {\n      type: type,\n      target: target,\n      currentTarget: currentTarget,\n      clientX: clientX,\n      clientY: clientY,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n};\n\nvar isEnabled = (0, _handle.forProp)('disabled', false);\nvar handleDown = (0, _handle.handle)(isEnabled, (0, _handle.adaptEvent)(makeTouchableEvent('onDown'), (0, _handle.forwardWithPrevent)('onDown')), (0, _handle.call)('activate'), (0, _handle.call)('startGesture')).named('handleDown');\nvar handleUp = (0, _handle.handle)(isEnabled, (0, _handle.call)('endGesture'), (0, _handle.call)('isTracking'), (0, _handle.adaptEvent)(makeTouchableEvent('onUp'), (0, _handle.forwardWithPrevent)('onUp')), (0, _handle.adaptEvent)(makeTouchableEvent('onTap'), (0, _handle.forward)('onTap')))[\"finally\"]((0, _handle.call)('deactivate')).named('handleUp');\nvar handleEnter = (0, _handle.handle)(isEnabled, (0, _handle.forProp)('noResume', false), (0, _handle.call)('enterGesture'), (0, _handle.call)('isPaused'), (0, _handle.call)('activate')).named('handleEnter');\nvar handleLeave = (0, _handle.handle)(isEnabled, (0, _handle.call)('leaveGesture'), (0, _handle.oneOf)([(0, _handle.forProp)('noResume', false), (0, _handle.call)('pause')], [_handle.returnsTrue, (0, _handle.call)('deactivate')])).named('handleLeave'); // Mouse event handlers\n\nvar handleMouseDown = (0, _handle.handle)((0, _handle.forward)('onMouseDown'), (0, _handle.call)('shouldAllowMouseEvent'), handleDown);\nvar handleMouseEnter = (0, _handle.handle)((0, _handle.forward)('onMouseEnter'), handleEnter);\nvar handleMouseMove = (0, _handle.handle)((0, _handle.forward)('onMouseMove'), (0, _handle.call)('moveGesture'));\nvar handleMouseLeave = (0, _handle.handle)((0, _handle.forward)('onMouseLeave'), handleLeave);\nvar handleMouseUp = (0, _handle.handle)((0, _handle.returnsTrue)((0, _handle.call)('setLastMouseUp')), (0, _handle.forward)('onMouseUp'), handleUp);\nvar handleClick = (0, _handle.handle)(isEnabled, // wrapping another handler to always forward onClick but, if onTap should occur, it should\n// occur first to keep in sync with the up handler which emits onTap first\n(0, _handle.handle)((0, _handle.call)('shouldAllowTap'), (0, _handle.call)('activate'), handleUp)[\"finally\"]((0, _handle.forward)('onClick'))); // Touch event handlers\n\nvar handleTouchStart = (0, _handle.handle)((0, _handle.forward)('onTouchStart'), (0, _handle.call)('startTouch'), handleDown);\nvar handleTouchMove = (0, _handle.handle)((0, _handle.forward)('onTouchMove'), (0, _handle.call)('isTracking'), // we don't receive enter/leave events during a touch so we have to simulate them by\n// detecting when the touch leaves the boundary. oneOf returns the value of whichever\n// branch it follows so we append moveHold to either to handle moves that aren't\n// entering or leaving\n(0, _handle.adaptEvent)(makeTouchableEvent('onMove'), (0, _handle.forward)('onMove')), (0, _handle.oneOf)([(0, _handle.call)('hasTouchLeftTarget'), handleLeave], [_handle.returnsTrue, handleEnter])[\"finally\"]((0, _handle.call)('moveGesture')));\nvar handleTouchEnd = (0, _handle.handle)((0, _handle.forward)('onTouchEnd'), // block the next mousedown to prevent duplicate touchable events\n(0, _handle.returnsTrue)((0, _handle.call)('setLastTouchEnd')), (0, _handle.call)('isTracking'), (0, _complement[\"default\"])((0, _handle.call)('hasTouchLeftTarget')), (0, _handle.returnsTrue)((0, _handle.call)('endTouch')), handleUp); // Global touchend/mouseup event handler to deactivate the component\n\nvar handleGlobalUp = (0, _handle.handle)((0, _handle.call)('isTracking'), (0, _handle.call)('deactivate'))[\"finally\"]((0, _handle.call)('endGesture'));\nvar handleGlobalMove = (0, _handle.handle)((0, _handle.call)('isTracking'), (0, _handle.call)('containsCurrentTarget'), (0, _handle.call)('moveGesture'));\nvar handleBlur = (0, _handle.handle)((0, _handle.forward)('onBlur'), (0, _handle.call)('hasFocus'), (0, _handle.call)('blurGesture'));\n\nvar Touch = /*#__PURE__*/function () {\n  function Touch() {\n    var _this = this;\n\n    _classCallCheck(this, Touch);\n\n    this.getHandlers = function () {\n      return _this.handlers;\n    };\n\n    this.context = {};\n    this.target = null;\n    this.targetHadFocus = false;\n    this.handle = _handle.handle.bind(this);\n    this.drag = new _Drag.Drag();\n    this.flick = new _Flick.Flick();\n    this.hold = new _Hold.Hold();\n    this.clickAllow = new _ClickAllow[\"default\"]();\n    this.handlers = {\n      onClick: handleClick.bindAs(this, 'handleClick'),\n      onBlur: handleBlur.bindAs(this, 'handleBlur'),\n      onMouseDown: handleMouseDown.bindAs(this, 'handleMouseDown'),\n      onMouseEnter: handleMouseEnter.bindAs(this, 'handleMouseEnter'),\n      onMouseMove: handleMouseMove.bindAs(this, 'handleMouseMove'),\n      onMouseLeave: handleMouseLeave.bindAs(this, 'handleMouseLeave'),\n      onMouseUp: handleMouseUp.bindAs(this, 'handleMouseUp')\n    };\n\n    if (_platform[\"default\"].touch) {\n      Object.assign(this.handlers, {\n        onTouchStart: handleTouchStart.bindAs(this, 'handleTouchStart'),\n        onTouchMove: handleTouchMove.bindAs(this, 'handleTouchMove'),\n        onTouchEnd: handleTouchEnd.bindAs(this, 'handleTouchEnd')\n      });\n    }\n\n    handleGlobalUp.bindAs(this, 'handleGlobalUp');\n    handleGlobalMove.bindAs(this, 'handleGlobalMove');\n  }\n\n  _createClass(Touch, [{\n    key: \"setPropsAndContext\",\n    value: function setPropsAndContext(config, state, setState) {\n      // remapping to props for better compatibility with core/handle and binding\n      this.props = config;\n      this.context.state = state;\n      this.context.setState = setState;\n    }\n  }, {\n    key: \"updateGestureConfig\",\n    value: function updateGestureConfig(dragConfig, flickConfig, holdConfig) {\n      this.config = (0, _config.mergeConfig)({\n        drag: dragConfig,\n        flick: flickConfig,\n        hold: holdConfig\n      });\n    }\n  }, {\n    key: \"addGlobalHandlers\",\n    value: function addGlobalHandlers() {\n      // ensure we clean up our internal state\n      if (_platform[\"default\"].touch) {\n        (0, _dispatcher.on)('touchend', this.handleGlobalUp, document);\n      }\n\n      (0, _dispatcher.on)('mouseup', this.handleGlobalUp, document);\n      (0, _dispatcher.on)('mousemove', this.handleGlobalMove, document);\n    }\n  }, {\n    key: \"removeGlobalHandlers\",\n    value: function removeGlobalHandlers() {\n      if (_platform[\"default\"].touch) {\n        (0, _dispatcher.off)('touchend', this.handleGlobalUp, document);\n      }\n\n      (0, _dispatcher.off)('mouseup', this.handleGlobalUp, document);\n      (0, _dispatcher.off)('mousemove', this.handleGlobalMove, document);\n    } // State Management\n\n  }, {\n    key: \"setTarget\",\n    value: function setTarget(target) {\n      this.target = target;\n    }\n  }, {\n    key: \"clearTarget\",\n    value: function clearTarget() {\n      this.target = null;\n    }\n  }, {\n    key: \"activate\",\n    value: function activate(ev) {\n      this.setTarget(ev.currentTarget);\n\n      if (this.props.getActive) {\n        this.context.setState(_state.States.Active);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"deactivate\",\n    value: function deactivate() {\n      this.clearTarget();\n\n      if (this.props.getActive) {\n        this.context.setState(_state.States.Inactive);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      if (this.props.getActive && this.context.state === _state.States.Active) {\n        this.context.setState(_state.States.Paused);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"disable\",\n    value: function disable() {\n      this.clearTarget();\n      this.hold.end();\n    }\n  }, {\n    key: \"updateProps\",\n    value: function updateProps(props) {\n      // Update the props onHoldStart, onHold, and onHoldEnd on any gesture (hold, flick, drag).\n      this.hold.updateProps(props);\n      this.flick.updateProps(props);\n      this.drag.updateProps(props);\n    } // Gesture Support\n\n  }, {\n    key: \"startTouch\",\n    value: function startTouch(_ref) {\n      var target = _ref.target,\n          currentTarget = _ref.currentTarget;\n\n      if (currentTarget.contains(target)) {\n        (0, _dispatcher.on)('contextmenu', _handle.preventDefault);\n        this.targetBounds = currentTarget.getBoundingClientRect();\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"endTouch\",\n    value: function endTouch() {\n      (0, _dispatcher.off)('contextmenu', _handle.preventDefault);\n      this.targetBounds = null;\n    }\n  }, {\n    key: \"startGesture\",\n    value: function startGesture(ev, props) {\n      var coords = getEventCoordinates(ev);\n      var _this$config = this.config,\n          hold = _this$config.hold,\n          flick = _this$config.flick,\n          drag = _this$config.drag;\n      this.hold.begin(hold, props, coords);\n      this.flick.begin(flick, props, coords);\n      this.drag.begin(drag, props, coords, this.target);\n      this.targetHadFocus = this.target === document.activeElement;\n      return true;\n    }\n  }, {\n    key: \"moveGesture\",\n    value: function moveGesture(ev) {\n      var coords = getEventCoordinates(ev);\n      this.hold.move(coords);\n      this.flick.move(coords);\n      this.drag.move(coords);\n      return true;\n    }\n  }, {\n    key: \"enterGesture\",\n    value: function enterGesture() {\n      this.drag.enter();\n      this.hold.enter();\n      return true;\n    }\n  }, {\n    key: \"leaveGesture\",\n    value: function leaveGesture() {\n      this.drag.leave();\n      this.hold.leave();\n      return true;\n    }\n  }, {\n    key: \"blurGesture\",\n    value: function blurGesture() {\n      this.targetHadFocus = false;\n      this.hold.blur();\n      this.flick.blur();\n      this.drag.blur();\n      return true;\n    }\n  }, {\n    key: \"endGesture\",\n    value: function endGesture() {\n      this.targetHadFocus = false;\n      this.hold.end();\n      this.flick.end();\n      this.drag.end();\n      return true;\n    } // Event handler utilities\n\n  }, {\n    key: \"isTracking\",\n    value: function isTracking() {\n      // verify we had a target and the up target is still within the current node\n      return this.target;\n    }\n  }, {\n    key: \"isPaused\",\n    value: function isPaused() {\n      return this.context.state === _state.States.Paused;\n    }\n  }, {\n    key: \"hasFocus\",\n    value: function hasFocus() {\n      return this.targetHadFocus;\n    }\n  }, {\n    key: \"hasTouchLeftTarget\",\n    value: function hasTouchLeftTarget(ev) {\n      var _this2 = this;\n\n      return Array.from(ev.changedTouches).reduce(function (hasLeft, _ref2) {\n        var pageX = _ref2.pageX,\n            pageY = _ref2.pageY;\n        var _this2$targetBounds = _this2.targetBounds,\n            left = _this2$targetBounds.left,\n            right = _this2$targetBounds.right,\n            top = _this2$targetBounds.top,\n            bottom = _this2$targetBounds.bottom;\n        return hasLeft && left > pageX || right < pageX || top > pageY || bottom < pageY;\n      }, true);\n    }\n  }, {\n    key: \"containsCurrentTarget\",\n    value: function containsCurrentTarget(_ref3) {\n      var target = _ref3.target;\n      return !this.target.contains(target);\n    }\n  }, {\n    key: \"shouldAllowMouseEvent\",\n    value: function shouldAllowMouseEvent(ev) {\n      return this.clickAllow.shouldAllowMouseEvent(ev);\n    }\n  }, {\n    key: \"shouldAllowTap\",\n    value: function shouldAllowTap(ev) {\n      return this.clickAllow.shouldAllowTap(ev);\n    }\n  }, {\n    key: \"setLastMouseUp\",\n    value: function setLastMouseUp(ev) {\n      this.clickAllow.setLastMouseUp(ev);\n    }\n  }, {\n    key: \"setLastTouchEnd\",\n    value: function setLastTouchEnd(ev) {\n      this.clickAllow.setLastTouchEnd(ev);\n    }\n  }]);\n\n  return Touch;\n}();\n\nexports.Touch = Touch;\nvar _default = Touch;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["C:/Users/tak43/remaking/node_modules/@enact/ui/Touchable/Touch.js"],"names":["Object","defineProperty","exports","value","Touch","_handle","require","_dispatcher","_complement","_interopRequireDefault","_platform","_config","_state","_ClickAllow","_Drag","_Flick","_Hold","obj","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","prototype","getEventCoordinates","ev","x","clientX","y","clientY","type","indexOf","targetTouches","makeTouchableEvent","currentTarget","pageX","pageY","changedTouches","isEnabled","forProp","handleDown","handle","adaptEvent","forwardWithPrevent","call","named","handleUp","forward","handleEnter","handleLeave","oneOf","returnsTrue","handleMouseDown","handleMouseEnter","handleMouseMove","handleMouseLeave","handleMouseUp","handleClick","handleTouchStart","handleTouchMove","handleTouchEnd","handleGlobalUp","handleGlobalMove","handleBlur","_this","getHandlers","handlers","context","targetHadFocus","bind","drag","Drag","flick","Flick","hold","Hold","clickAllow","onClick","bindAs","onBlur","onMouseDown","onMouseEnter","onMouseMove","onMouseLeave","onMouseUp","touch","assign","onTouchStart","onTouchMove","onTouchEnd","setPropsAndContext","config","state","setState","updateGestureConfig","dragConfig","flickConfig","holdConfig","mergeConfig","addGlobalHandlers","on","document","removeGlobalHandlers","off","setTarget","clearTarget","activate","getActive","States","Active","deactivate","Inactive","pause","Paused","disable","end","updateProps","startTouch","_ref","contains","preventDefault","targetBounds","getBoundingClientRect","endTouch","startGesture","coords","_this$config","begin","activeElement","moveGesture","move","enterGesture","enter","leaveGesture","leave","blurGesture","blur","endGesture","isTracking","isPaused","hasFocus","hasTouchLeftTarget","_this2","Array","from","reduce","hasLeft","_ref2","_this2$targetBounds","left","right","top","bottom","containsCurrentTarget","_ref3","shouldAllowMouseEvent","shouldAllowTap","setLastMouseUp","setLastTouchEnd","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Touch = exports[\"default\"] = void 0;\n\nvar _handle = require(\"@enact/core/handle\");\n\nvar _dispatcher = require(\"@enact/core/dispatcher\");\n\nvar _complement = _interopRequireDefault(require(\"ramda/src/complement\"));\n\nvar _platform = _interopRequireDefault(require(\"@enact/core/platform\"));\n\nvar _config = require(\"./config\");\n\nvar _state = require(\"./state\");\n\nvar _ClickAllow = _interopRequireDefault(require(\"./ClickAllow\"));\n\nvar _Drag = require(\"./Drag\");\n\nvar _Flick = require(\"./Flick\");\n\nvar _Hold = require(\"./Hold\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar getEventCoordinates = function getEventCoordinates(ev) {\n  var x = ev.clientX,\n      y = ev.clientY,\n      type = ev.type;\n\n  if (type.indexOf('touch') === 0) {\n    x = ev.targetTouches[0].clientX;\n    y = ev.targetTouches[0].clientY;\n  }\n\n  return {\n    x: x,\n    y: y\n  };\n}; // Establish a standard payload for onDown/onUp/onTap events and pass it along to a handler\n\n\nvar makeTouchableEvent = function makeTouchableEvent(type) {\n  return function (ev) {\n    var target = ev.target,\n        currentTarget = ev.currentTarget;\n    var clientX = ev.clientX,\n        clientY = ev.clientY,\n        pageX = ev.pageX,\n        pageY = ev.pageY;\n\n    if (ev.changedTouches) {\n      clientX = ev.changedTouches[0].clientX;\n      clientY = ev.changedTouches[0].clientY;\n      pageX = ev.changedTouches[0].pageX;\n      pageY = ev.changedTouches[0].pageY;\n    }\n\n    return {\n      type: type,\n      target: target,\n      currentTarget: currentTarget,\n      clientX: clientX,\n      clientY: clientY,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n};\n\nvar isEnabled = (0, _handle.forProp)('disabled', false);\nvar handleDown = (0, _handle.handle)(isEnabled, (0, _handle.adaptEvent)(makeTouchableEvent('onDown'), (0, _handle.forwardWithPrevent)('onDown')), (0, _handle.call)('activate'), (0, _handle.call)('startGesture')).named('handleDown');\nvar handleUp = (0, _handle.handle)(isEnabled, (0, _handle.call)('endGesture'), (0, _handle.call)('isTracking'), (0, _handle.adaptEvent)(makeTouchableEvent('onUp'), (0, _handle.forwardWithPrevent)('onUp')), (0, _handle.adaptEvent)(makeTouchableEvent('onTap'), (0, _handle.forward)('onTap')))[\"finally\"]((0, _handle.call)('deactivate')).named('handleUp');\nvar handleEnter = (0, _handle.handle)(isEnabled, (0, _handle.forProp)('noResume', false), (0, _handle.call)('enterGesture'), (0, _handle.call)('isPaused'), (0, _handle.call)('activate')).named('handleEnter');\nvar handleLeave = (0, _handle.handle)(isEnabled, (0, _handle.call)('leaveGesture'), (0, _handle.oneOf)([(0, _handle.forProp)('noResume', false), (0, _handle.call)('pause')], [_handle.returnsTrue, (0, _handle.call)('deactivate')])).named('handleLeave'); // Mouse event handlers\n\nvar handleMouseDown = (0, _handle.handle)((0, _handle.forward)('onMouseDown'), (0, _handle.call)('shouldAllowMouseEvent'), handleDown);\nvar handleMouseEnter = (0, _handle.handle)((0, _handle.forward)('onMouseEnter'), handleEnter);\nvar handleMouseMove = (0, _handle.handle)((0, _handle.forward)('onMouseMove'), (0, _handle.call)('moveGesture'));\nvar handleMouseLeave = (0, _handle.handle)((0, _handle.forward)('onMouseLeave'), handleLeave);\nvar handleMouseUp = (0, _handle.handle)((0, _handle.returnsTrue)((0, _handle.call)('setLastMouseUp')), (0, _handle.forward)('onMouseUp'), handleUp);\nvar handleClick = (0, _handle.handle)(isEnabled, // wrapping another handler to always forward onClick but, if onTap should occur, it should\n// occur first to keep in sync with the up handler which emits onTap first\n(0, _handle.handle)((0, _handle.call)('shouldAllowTap'), (0, _handle.call)('activate'), handleUp)[\"finally\"]((0, _handle.forward)('onClick'))); // Touch event handlers\n\nvar handleTouchStart = (0, _handle.handle)((0, _handle.forward)('onTouchStart'), (0, _handle.call)('startTouch'), handleDown);\nvar handleTouchMove = (0, _handle.handle)((0, _handle.forward)('onTouchMove'), (0, _handle.call)('isTracking'), // we don't receive enter/leave events during a touch so we have to simulate them by\n// detecting when the touch leaves the boundary. oneOf returns the value of whichever\n// branch it follows so we append moveHold to either to handle moves that aren't\n// entering or leaving\n(0, _handle.adaptEvent)(makeTouchableEvent('onMove'), (0, _handle.forward)('onMove')), (0, _handle.oneOf)([(0, _handle.call)('hasTouchLeftTarget'), handleLeave], [_handle.returnsTrue, handleEnter])[\"finally\"]((0, _handle.call)('moveGesture')));\nvar handleTouchEnd = (0, _handle.handle)((0, _handle.forward)('onTouchEnd'), // block the next mousedown to prevent duplicate touchable events\n(0, _handle.returnsTrue)((0, _handle.call)('setLastTouchEnd')), (0, _handle.call)('isTracking'), (0, _complement[\"default\"])((0, _handle.call)('hasTouchLeftTarget')), (0, _handle.returnsTrue)((0, _handle.call)('endTouch')), handleUp); // Global touchend/mouseup event handler to deactivate the component\n\nvar handleGlobalUp = (0, _handle.handle)((0, _handle.call)('isTracking'), (0, _handle.call)('deactivate'))[\"finally\"]((0, _handle.call)('endGesture'));\nvar handleGlobalMove = (0, _handle.handle)((0, _handle.call)('isTracking'), (0, _handle.call)('containsCurrentTarget'), (0, _handle.call)('moveGesture'));\nvar handleBlur = (0, _handle.handle)((0, _handle.forward)('onBlur'), (0, _handle.call)('hasFocus'), (0, _handle.call)('blurGesture'));\n\nvar Touch = /*#__PURE__*/function () {\n  function Touch() {\n    var _this = this;\n\n    _classCallCheck(this, Touch);\n\n    this.getHandlers = function () {\n      return _this.handlers;\n    };\n\n    this.context = {};\n    this.target = null;\n    this.targetHadFocus = false;\n    this.handle = _handle.handle.bind(this);\n    this.drag = new _Drag.Drag();\n    this.flick = new _Flick.Flick();\n    this.hold = new _Hold.Hold();\n    this.clickAllow = new _ClickAllow[\"default\"]();\n    this.handlers = {\n      onClick: handleClick.bindAs(this, 'handleClick'),\n      onBlur: handleBlur.bindAs(this, 'handleBlur'),\n      onMouseDown: handleMouseDown.bindAs(this, 'handleMouseDown'),\n      onMouseEnter: handleMouseEnter.bindAs(this, 'handleMouseEnter'),\n      onMouseMove: handleMouseMove.bindAs(this, 'handleMouseMove'),\n      onMouseLeave: handleMouseLeave.bindAs(this, 'handleMouseLeave'),\n      onMouseUp: handleMouseUp.bindAs(this, 'handleMouseUp')\n    };\n\n    if (_platform[\"default\"].touch) {\n      Object.assign(this.handlers, {\n        onTouchStart: handleTouchStart.bindAs(this, 'handleTouchStart'),\n        onTouchMove: handleTouchMove.bindAs(this, 'handleTouchMove'),\n        onTouchEnd: handleTouchEnd.bindAs(this, 'handleTouchEnd')\n      });\n    }\n\n    handleGlobalUp.bindAs(this, 'handleGlobalUp');\n    handleGlobalMove.bindAs(this, 'handleGlobalMove');\n  }\n\n  _createClass(Touch, [{\n    key: \"setPropsAndContext\",\n    value: function setPropsAndContext(config, state, setState) {\n      // remapping to props for better compatibility with core/handle and binding\n      this.props = config;\n      this.context.state = state;\n      this.context.setState = setState;\n    }\n  }, {\n    key: \"updateGestureConfig\",\n    value: function updateGestureConfig(dragConfig, flickConfig, holdConfig) {\n      this.config = (0, _config.mergeConfig)({\n        drag: dragConfig,\n        flick: flickConfig,\n        hold: holdConfig\n      });\n    }\n  }, {\n    key: \"addGlobalHandlers\",\n    value: function addGlobalHandlers() {\n      // ensure we clean up our internal state\n      if (_platform[\"default\"].touch) {\n        (0, _dispatcher.on)('touchend', this.handleGlobalUp, document);\n      }\n\n      (0, _dispatcher.on)('mouseup', this.handleGlobalUp, document);\n      (0, _dispatcher.on)('mousemove', this.handleGlobalMove, document);\n    }\n  }, {\n    key: \"removeGlobalHandlers\",\n    value: function removeGlobalHandlers() {\n      if (_platform[\"default\"].touch) {\n        (0, _dispatcher.off)('touchend', this.handleGlobalUp, document);\n      }\n\n      (0, _dispatcher.off)('mouseup', this.handleGlobalUp, document);\n      (0, _dispatcher.off)('mousemove', this.handleGlobalMove, document);\n    } // State Management\n\n  }, {\n    key: \"setTarget\",\n    value: function setTarget(target) {\n      this.target = target;\n    }\n  }, {\n    key: \"clearTarget\",\n    value: function clearTarget() {\n      this.target = null;\n    }\n  }, {\n    key: \"activate\",\n    value: function activate(ev) {\n      this.setTarget(ev.currentTarget);\n\n      if (this.props.getActive) {\n        this.context.setState(_state.States.Active);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"deactivate\",\n    value: function deactivate() {\n      this.clearTarget();\n\n      if (this.props.getActive) {\n        this.context.setState(_state.States.Inactive);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      if (this.props.getActive && this.context.state === _state.States.Active) {\n        this.context.setState(_state.States.Paused);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"disable\",\n    value: function disable() {\n      this.clearTarget();\n      this.hold.end();\n    }\n  }, {\n    key: \"updateProps\",\n    value: function updateProps(props) {\n      // Update the props onHoldStart, onHold, and onHoldEnd on any gesture (hold, flick, drag).\n      this.hold.updateProps(props);\n      this.flick.updateProps(props);\n      this.drag.updateProps(props);\n    } // Gesture Support\n\n  }, {\n    key: \"startTouch\",\n    value: function startTouch(_ref) {\n      var target = _ref.target,\n          currentTarget = _ref.currentTarget;\n\n      if (currentTarget.contains(target)) {\n        (0, _dispatcher.on)('contextmenu', _handle.preventDefault);\n        this.targetBounds = currentTarget.getBoundingClientRect();\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"endTouch\",\n    value: function endTouch() {\n      (0, _dispatcher.off)('contextmenu', _handle.preventDefault);\n      this.targetBounds = null;\n    }\n  }, {\n    key: \"startGesture\",\n    value: function startGesture(ev, props) {\n      var coords = getEventCoordinates(ev);\n      var _this$config = this.config,\n          hold = _this$config.hold,\n          flick = _this$config.flick,\n          drag = _this$config.drag;\n      this.hold.begin(hold, props, coords);\n      this.flick.begin(flick, props, coords);\n      this.drag.begin(drag, props, coords, this.target);\n      this.targetHadFocus = this.target === document.activeElement;\n      return true;\n    }\n  }, {\n    key: \"moveGesture\",\n    value: function moveGesture(ev) {\n      var coords = getEventCoordinates(ev);\n      this.hold.move(coords);\n      this.flick.move(coords);\n      this.drag.move(coords);\n      return true;\n    }\n  }, {\n    key: \"enterGesture\",\n    value: function enterGesture() {\n      this.drag.enter();\n      this.hold.enter();\n      return true;\n    }\n  }, {\n    key: \"leaveGesture\",\n    value: function leaveGesture() {\n      this.drag.leave();\n      this.hold.leave();\n      return true;\n    }\n  }, {\n    key: \"blurGesture\",\n    value: function blurGesture() {\n      this.targetHadFocus = false;\n      this.hold.blur();\n      this.flick.blur();\n      this.drag.blur();\n      return true;\n    }\n  }, {\n    key: \"endGesture\",\n    value: function endGesture() {\n      this.targetHadFocus = false;\n      this.hold.end();\n      this.flick.end();\n      this.drag.end();\n      return true;\n    } // Event handler utilities\n\n  }, {\n    key: \"isTracking\",\n    value: function isTracking() {\n      // verify we had a target and the up target is still within the current node\n      return this.target;\n    }\n  }, {\n    key: \"isPaused\",\n    value: function isPaused() {\n      return this.context.state === _state.States.Paused;\n    }\n  }, {\n    key: \"hasFocus\",\n    value: function hasFocus() {\n      return this.targetHadFocus;\n    }\n  }, {\n    key: \"hasTouchLeftTarget\",\n    value: function hasTouchLeftTarget(ev) {\n      var _this2 = this;\n\n      return Array.from(ev.changedTouches).reduce(function (hasLeft, _ref2) {\n        var pageX = _ref2.pageX,\n            pageY = _ref2.pageY;\n        var _this2$targetBounds = _this2.targetBounds,\n            left = _this2$targetBounds.left,\n            right = _this2$targetBounds.right,\n            top = _this2$targetBounds.top,\n            bottom = _this2$targetBounds.bottom;\n        return hasLeft && left > pageX || right < pageX || top > pageY || bottom < pageY;\n      }, true);\n    }\n  }, {\n    key: \"containsCurrentTarget\",\n    value: function containsCurrentTarget(_ref3) {\n      var target = _ref3.target;\n      return !this.target.contains(target);\n    }\n  }, {\n    key: \"shouldAllowMouseEvent\",\n    value: function shouldAllowMouseEvent(ev) {\n      return this.clickAllow.shouldAllowMouseEvent(ev);\n    }\n  }, {\n    key: \"shouldAllowTap\",\n    value: function shouldAllowTap(ev) {\n      return this.clickAllow.shouldAllowTap(ev);\n    }\n  }, {\n    key: \"setLastMouseUp\",\n    value: function setLastMouseUp(ev) {\n      this.clickAllow.setLastMouseUp(ev);\n    }\n  }, {\n    key: \"setLastTouchEnd\",\n    value: function setLastTouchEnd(ev) {\n      this.clickAllow.setLastTouchEnd(ev);\n    }\n  }]);\n\n  return Touch;\n}();\n\nexports.Touch = Touch;\nvar _default = Touch;\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"module"}